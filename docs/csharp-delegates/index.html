<!DOCTYPE html><html lang="zh-Hant"> <head><meta charset="UTF-8"><meta name="description" content="柴魚筆記"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.10.3"><title>柴魚筆記</title><link rel="stylesheet" href="/assets/style.HZtN7SYH.css"></head> <body>  <div class="nav-outer" data-astro-cid-pux6a34n> <nav class="nav-inner" data-astro-cid-pux6a34n> <span class="logo" data-astro-cid-pux6a34n> <a href="/" data-astro-cid-pux6a34n> <img src="/favicon.svg" data-astro-cid-pux6a34n> </a> </span> <ul data-astro-cid-pux6a34n> <li data-astro-cid-pux6a34n> <a href="/" data-astro-cid-pux6a34n> <span data-astro-cid-pux6a34n>Home</span> </a> </li><li data-astro-cid-pux6a34n> <a href="/author/Katsuobushi" data-astro-cid-pux6a34n> <span data-astro-cid-pux6a34n>Author</span> </a> </li><li data-astro-cid-pux6a34n> <a href="/tags" data-astro-cid-pux6a34n> <span data-astro-cid-pux6a34n>Tags</span> </a> </li> </ul> </nav> </div>   <header class="main-header has-cover" data-astro-cid-yl355ysp> <div class="content" data-astro-cid-yl355ysp> <div class="header-box" data-astro-cid-yl355ysp>  <div class="post-info" data-astro-cid-qwcrhz7j> <div class="post-type" data-astro-cid-qwcrhz7j> <span data-astro-cid-qwcrhz7j>Article</span>  <span class="post-type-dash" data-astro-cid-qwcrhz7j>－</span> <span data-astro-cid-qwcrhz7j>C#</span>  </div> <h1 class="post-title" data-astro-cid-qwcrhz7j>Delegates 委派</h1> <div class="post-metadata" data-astro-cid-qwcrhz7j> <span class="author-avatar" data-astro-cid-qwcrhz7j> <img src="/favicon.svg" data-astro-cid-qwcrhz7j> </span> <div class="metadata-right" data-astro-cid-qwcrhz7j> <h4 class="metadata-author" data-astro-cid-qwcrhz7j>Katsuobushi</h4> <span class="metadata-datetime" data-astro-cid-qwcrhz7j>2024-02-20T00:00:00+08:00</span> </div> </div> </div>   </div> <div class="main-cover" data-astro-cid-yl355ysp> <img src="/assets/VisualStudioGray.BNL0rM63_1nMgSj.webp" alt="" data-astro-cid-yl355ysp width="1920" height="1080" loading="lazy" decoding="async"> </div> </div> </header>  <article> <div class="content"> <div class="markdown">  <p>我們可以把委派想像成是一個沒有內容的函式，可以被用來當作是某個函式的臨時替身，當我們決定好要用哪個函式時再將真正的函式變成委派實體，並呼叫委派實體以執行該函式。</p>
<h2 id="委派的特性">委派的特性</h2>
<ul>
<li>委派是一個類別</li>
<li>委派可以將方法當作參數來參考</li>
<li>委派可以將方法當作參數來傳遞</li>
<li>委派可以用來定義回呼函式（Callback function）</li>
</ul>
<h2 id="委派的用處">委派的用處</h2>
<ul>
<li>可以把一個函式當成參數傳遞到另一個函式去執行</li>
<li>可以用來處理事件</li>
<li>可以用在回呼函式
<ul>
<li>當某段程式需要在特定時間或是特定條件下執行時很好用</li>
</ul>
</li>
<li>可以用在函式的多播</li>
</ul>
<h2 id="名詞定義">名詞定義</h2>
<ul>
<li>委派（Delegates）：是一種類別，也是一種有特定參數和回傳值的參考，定義委派時有點像是為某些方法定義介面。</li>
<li>委派實體（Delegate Instance）：委派實例化後會產生委派執行個體，委派執行個體可以被呼叫也可以被當作參數傳遞。</li>
</ul>
<h2 id="順序">順序</h2>
<ol>
<li>定義委派</li>
<li>定義一個方法，其參數及回傳值必須與委派相同</li>
<li>定義實際執行該委派的函式</li>
<li>建立、傳遞及呼叫委派實體</li>
</ol>
<h3 id="定義委派">定義委派</h3>
<p>定義委派會使用到<code>delegate</code>關鍵字，必須定義其名稱、參數以及回傳值。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#F97583">public</span><span style="color:#F97583"> delegate</span><span style="color:#F97583"> void</span><span style="color:#B392F0"> SendDrinks</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">string</span><span style="color:#B392F0"> order</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span></code></pre>
<h3 id="定義與委派結構相同的函式">定義與委派結構相同的函式</h3>
<p>將函式的參數及回傳值設定為與委派相同時，即可被指定給委派實體，當作委派實體來進行傳遞或呼叫。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#6A737D">// 定義一個名稱為SendNearDrinks的方法，其參數及回傳值皆與委派相同</span></span>
<span class="line"><span style="color:#F97583">public</span><span style="color:#F97583"> static</span><span style="color:#F97583"> void</span><span style="color:#B392F0"> SendNearDrinks</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">string</span><span style="color:#B392F0"> drink</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#E1E4E8">	Console.</span><span style="color:#B392F0">WriteLine</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">$"您的{</span><span style="color:#E1E4E8">drink</span><span style="color:#9ECBFF">}送到囉"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 定義一個名稱為SendFarDrinks的方法，其參數及回傳值皆與委派相同</span></span>
<span class="line"><span style="color:#F97583">public</span><span style="color:#F97583"> static</span><span style="color:#F97583"> void</span><span style="color:#B392F0"> SendFarDrinks</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">string</span><span style="color:#B392F0"> drink</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#E1E4E8">	Console.</span><span style="color:#B392F0">WriteLine</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">$"您的{</span><span style="color:#E1E4E8">drink</span><span style="color:#9ECBFF">}送到囉，跟您收取外送費50元"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>範例中<code>SendNearDrinks</code>與<code>SendFarDrinks</code>的參數皆為一個字串，回傳值皆為<code>void</code>，與委派相同，可被指定給委派實體。</p>
<h3 id="定義實際執行該委派的函式">定義實際執行該委派的函式</h3>
<p>在[[#定義委派]]中我們定義了名稱為<code>SendDrinks</code>的委派，我們可以將該委派作為某個函式（CreateGroupBuying）的參數。該參數（send）是一個委派實體，可以在函式內被調用，使用委派變數名稱加上參數即可執行該委派。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#F97583">public</span><span style="color:#F97583"> static</span><span style="color:#F97583"> void</span><span style="color:#B392F0"> CreateGroupBuying</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">string</span><span style="color:#B392F0"> order</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">SendDrinks</span><span style="color:#B392F0"> send</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#E1E4E8">	Console.</span><span style="color:#B392F0">WriteLine</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">$"已建立訂單：{</span><span style="color:#E1E4E8">order</span><span style="color:#9ECBFF">}"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#B392F0">	send</span><span style="color:#E1E4E8">(order);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<h3 id="建立傳遞及呼叫委派實體">建立、傳遞及呼叫委派實體</h3>
<p>當我們將與委派結構相同的函式（SendFarDrinks）傳遞給實際執行該委派的函式（CreateGroupBuying）時，會自動建立委派實體，並且該委派實體可以在實際執行該委派的函式內被調用。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#F97583">static</span><span style="color:#F97583"> void</span><span style="color:#B392F0"> Main</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">[] </span><span style="color:#B392F0">args</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#B392F0">	CreateGroupBuying</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"一杯鮮奶茶微微"</span><span style="color:#E1E4E8">, SendFarDrinks);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<h6 id="參考資料">參考資料</h6>
<ul>
<li><a href="https://learn.microsoft.com/zh-tw/dotnet/csharp/programming-guide/delegates/how-to-declare-instantiate-and-use-a-delegate">如何宣告、具現化和使用委派 (C# 程式設計指南)</a></li>
<li><a href="https://vito-note.blogspot.com/2014/08/blog-post_65.html">抽象、介面、委派、事件</a></li>
<li><a href="https://eric0806.blogspot.com/2015/01/dotnet-delegate-usage.html">.Net委派(delegate)的簡易解說與用法</a></li>
<li><a href="https://medium.com/@jason8410271027/c-%E5%A7%94%E6%B4%BE-delegate-%E5%9F%BA%E6%9C%AC%E6%87%89%E7%94%A8%E7%AF%87-5b0b4d448ca3">(C#) 委派(Delegate)基本應用篇</a></li>
<li><a href="https://stackify.com/c-delegates-definition-types-examples/">C# Delegates: Definition, Types &#x26; Examples</a></li>
<li><a href="https://functionalprogramming.medium.com/c-delegates-are-just-interfaces-with-one-method-88474ca97149">C# Delegates are Just Interfaces with one method</a></li>
</ul>  </div>  <div class="post-footer" data-astro-cid-ctzdi7mj> <div class="post-tags" data-astro-cid-ctzdi7mj> <span class="post-tags-label" data-astro-cid-ctzdi7mj>Topic</span> <div class="post-tags-list" data-astro-cid-ctzdi7mj> <a class="post-tag-badge" href="/tag/csharp" data-astro-cid-ctzdi7mj> C# </a> </div> </div> <div class="post-nav" data-astro-cid-ctzdi7mj> <div class="post-nav-half" data-astro-cid-ctzdi7mj> <a class="post-nav-prev" href="/solid-srp" data-astro-cid-ctzdi7mj> <span class="post-nav-icon-left" data-astro-cid-ctzdi7mj></span> <h2 class="post-nav-title" data-astro-cid-ctzdi7mj>單一職責原則（Single Responsibility Principle，SRP）</h2> <p class="post-nav-abstract" data-astro-cid-ctzdi7mj>在CleanArchitecture中提到了SRP的定義：A module should have one, and only one, reason to change.書中的定義是「一個模組應該只有一個被改變的原因」。當某個模組會因為多個角色而改變，換句話說就是某個模組有多個「reason to change」時，則違反SRP。</p> <p class="post-nav-metadata" data-astro-cid-ctzdi7mj> 2024-04-01T00:00:00+08:00 </p> </a> </div> <div class="post-nav-half" data-astro-cid-ctzdi7mj> <a class="post-nav-next" href="/sql-having-clause" data-astro-cid-ctzdi7mj> <span class="post-nav-icon-right" data-astro-cid-ctzdi7mj></span> <h2 class="post-nav-title" data-astro-cid-ctzdi7mj>HAVING語句</h2> <p class="post-nav-abstract" data-astro-cid-ctzdi7mj>HAVING語句用來篩選聚合函數執行後的結果</p> <p class="post-nav-metadata" data-astro-cid-ctzdi7mj> 2024-02-18T00:00:00+08:00 </p> </a> </div> </div> <div class="post-comments" data-astro-cid-ctzdi7mj> <script src="https://utteranc.es/client.js" repo="vincent87720/BlogComments" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async></script> </div> </div>  </div> </article>  <div class="nav-outer" data-astro-cid-bpgok6sl> <nav class="nav-inner" data-astro-cid-bpgok6sl> <span data-astro-cid-bpgok6sl>柴魚筆記 © 2019-2024</span> <div class="nav-external-link" data-astro-cid-bpgok6sl> <a href="https://github.com/vincent87720" data-astro-cid-bpgok6sl>Github</a><a href="https://www.linkedin.com/in/vincent87720" data-astro-cid-bpgok6sl>LinkedIn</a> </div> <div class="nav-item-grow" data-astro-cid-bpgok6sl></div> <span class="nav-pubinfo" data-astro-cid-bpgok6sl>
Published with
<a href="https://astro.build" target="_blank" data-astro-cid-bpgok6sl>Astro</a>
• Theme modified from
<a href="https://github.com/zutrinken/attila" target="_blank" data-astro-cid-bpgok6sl>Attila</a>
• Technical support by
<a href="https://millieattic-millieqius-projects.vercel.app" target="_blank" data-astro-cid-bpgok6sl>Millie</a> </span> </nav> </div>   </body></html>